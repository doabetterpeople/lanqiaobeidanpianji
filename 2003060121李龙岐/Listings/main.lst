C51 COMPILER V9.59.0.0   MAIN                                                              03/08/2022 19:37:30 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <STC15F2K60S2.H>
   2          #include "iic.h"
   3          #include "Nixie.h"
   4          #include "onewire.h"
   5          #include "absacc.h"
   6          
   7          sbit S4 = P3^3;
   8          
   9          unsigned char temp;
  10          void DS18B20_Read()
  11          {
  12   1        unsigned char LSB,MSB;
  13   1        init_ds18b20();
  14   1        Write_DS18B20(0xcc);
  15   1        Write_DS18B20(0x44);
  16   1        
  17   1        init_ds18b20();
  18   1        Write_DS18B20(0xcc);
  19   1        Write_DS18B20(0xbe);
  20   1        
  21   1        LSB = Read_DS18B20();
  22   1        MSB = Read_DS18B20();
  23   1        
  24   1        temp = (MSB<<8)|LSB;
  25   1        if(temp&0xf800==0x0000)
  26   1        {
  27   2          temp=temp>>4;
  28   2          temp = temp*10;
  29   2          temp = temp+LSB*0.0625;
  30   2        }
  31   1      }
  32          void Delay(unsigned int t)
  33          {
  34   1        while(t--);
  35   1      }
  36          void Nixie_Run()
  37          {
  38   1        Display_NixieBit(0,0xc6);
  39   1        Delay(200);
  40   1        Display_NixieBit(1,NixieTableNoDot[temp/100]);
  41   1        Delay(200);
  42   1        Display_NixieBit(2,NixieTableDot[temp/10%10]);
  43   1        Delay(200);
  44   1        Display_NixieBit(3,NixieTableNoDot[temp%10]);
  45   1        Delay(200);
  46   1        XBYTE[0XC000] = 0xf0;
  47   1        XBYTE[0XE000] = 0xff;
  48   1        Delay(200);
  49   1      }
  50          
  51          
  52          void Timer0Init(void)   //50毫秒@12.000MHz
  53          {
  54   1        AUXR &= 0x7F;   //定时器时钟12T模式
C51 COMPILER V9.59.0.0   MAIN                                                              03/08/2022 19:37:30 PAGE 2   

  55   1        TMOD &= 0xF0;   //设置定时器模式
  56   1        TMOD |= 0x01;   //设置定时器模式
  57   1        TL0 = 0xB0;   //设置定时初值
  58   1        TH0 = 0x3C;   //设置定时初值
  59   1        TF0 = 0;    //清除TF0标志
  60   1        TR0 = 1;    //定时器0开始计时
  61   1        EA = 1;
  62   1        ET0 = 1;
  63   1      }
  64          
  65          unsigned char count;
  66          unsigned char flag1=1;
  67          void Timer_Service() interrupt 1
  68          {
  69   1        TL0 = 0xB0;   //设置定时初值
  70   1        TH0 = 0x3C;   //设置定时初值
  71   1        count++;
  72   1        if(count>20)
  73   1        {
  74   2          count=0;
  75   2          if(flag1==1)
  76   2          {
  77   3            flag1=2;
  78   3          }
  79   2          else if(flag1==2)
  80   2          {
  81   3            flag1=1;
  82   3          }
  83   2        }
  84   1      }
  85          
  86          
  87          
  88          void Check()
  89          {
  90   1        unsigned int i;
  91   1        if(temp>250)
  92   1        {
  93   2          if(flag1==1)
  94   2          {
  95   3            XBYTE[0X8000] = 0X55;
  96   3          }
  97   2          if(flag1==2)
  98   2          {
  99   3            XBYTE[0X8000] = 0XFF;
 100   3          }
 101   2        }
 102   1      }
*** WARNING C280 IN LINE 90 OF main.c: 'i': unreferenced local variable
 103          unsigned int dat_rd;
 104          void Read_Ain3()
 105          {
 106   1        IIC_Start(); 
 107   1        IIC_SendByte(0x90);
 108   1        IIC_WaitAck();
 109   1        IIC_SendByte(0x43);
 110   1        IIC_WaitAck();
 111   1        IIC_Stop(); 
 112   1        
 113   1        IIC_Start(); 
 114   1        IIC_SendByte(0x91);
 115   1        IIC_WaitAck();
C51 COMPILER V9.59.0.0   MAIN                                                              03/08/2022 19:37:30 PAGE 3   

 116   1        dat_rd=IIC_RecByte()*2;
 117   1        IIC_WaitAck();
 118   1        IIC_SendAck(0);
 119   1        IIC_Stop();
 120   1      }
 121          void RD3_Display()
 122          { 
 123   1        XBYTE[0XC000] = 0x1f;
 124   1        XBYTE[0XE000] = 0xff;
 125   1        Delay(200);
 126   1        Display_NixieBit(5,0xc1);
 127   1        Delay(200);
 128   1        Display_NixieBit(6,NixieTableDot[dat_rd/100]);
 129   1        Delay(200);
 130   1        Display_NixieBit(7,NixieTableNoDot[dat_rd/10%10]);
 131   1        Delay(200);
 132   1        XBYTE[0XC000] = 0xff;
 133   1        XBYTE[0XE000] = 0xff;
 134   1      }
 135          unsigned char flag=1;
 136          void Key_Scan()
 137          {
 138   1        if(S4==0)
 139   1        {
 140   2            Delay(20);
 141   2            if(S4==0)
 142   2            {
 143   3              if(flag==1)
 144   3              {
 145   4                flag=2;
 146   4                while(S4==0)
 147   4                {
 148   5                  DS18B20_Read();
 149   5                  Nixie_Run();
 150   5                }
 151   4              }
 152   3              else if(flag==2)
 153   3              {
 154   4                flag=1;
 155   4                while(S4==0)
 156   4                {
 157   5                  Read_Ain3();
 158   5                  RD3_Display();
 159   5                }
 160   4              }
 161   3            }
 162   2        }
 163   1      }
 164          
 165          void System_init()
 166          {
 167   1        XBYTE[0X8000]=0XFF;
 168   1        XBYTE[0XA000]=0X00;
 169   1      }
 170          
 171          void main()
 172          {
 173   1        System_init();
 174   1        Timer0Init();
 175   1        while(1)
 176   1        {
 177   2          Read_Ain3();
C51 COMPILER V9.59.0.0   MAIN                                                              03/08/2022 19:37:30 PAGE 4   

 178   2          DS18B20_Read(); 
 179   2          Key_Scan();
 180   2          if(flag==1)
 181   2          {
 182   3            Nixie_Run();
 183   3          }
 184   2          if(flag==2)
 185   2          {
 186   3            RD3_Display();
 187   3          }
 188   2          Check();
 189   2        }
 190   1      }
*** WARNING C294 IN LINE 27 OF main.c: unreachable code


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    544    ----
   CONSTANT SIZE    =     20    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
